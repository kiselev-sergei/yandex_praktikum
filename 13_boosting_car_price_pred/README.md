# Определение стоимости автомобилей

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Вам нужно построить модель для определения стоимости.

Заказчику важны:

* качество предсказания;
* скорость предсказания;
* время обучения.

Описание данных

Признаки

- DateCrawled — дата скачивания анкеты из базы
- VehicleType — тип автомобильного кузова
- RegistrationYear — год регистрации автомобиля
- Gearbox — тип коробки передач
- Power — мощность (л. с.)
- Model — модель автомобиля
- Kilometer — пробег (км)
- RegistrationMonth — месяц регистрации автомобиля
- FuelType — тип топлива
- Brand — марка автомобиля
- Repaired — была машина в ремонте или нет
- DateCreated — дата создания анкеты
- NumberOfPictures — количество фотографий автомобиля
- PostalCode — почтовый индекс владельца анкеты (пользователя)
- LastSeen — дата последней активности пользователя

Целевой признак

- Price — цена (евро)

## Цель исследования:

Построение модели для определения рыночной стоимости автомобиля, для оценки качества моделей будет применяться метрика RMSE, ее значение должно быть меньше 2500. 

## Ход исследования:

Шаг 1. Загрузка и изучение данных.
В ходе предобработки данных, был изучен датасет на предмет выбросов в данных, наличия дубликатов и пропущенных значений.

- Автомобили с ценой ниже 10 евро в расчет не будут приниматься.
- Дата скачивания анкеты, дата создания анкеты, количество фотографий автомобиля, дата последней активности пользователя удалены из набора данных.
- Отсутствующие значения в столбце тип кузова и тип топлива добавлены к категории 'other'.
- Строки с отсутствующими значения в столбце тип коробки передач удалены.
- У признака мощность выявлено 22 тычячи нулевых значений, их и можно считать пропусками. Мощность зачастую зависит от модели и года выпуска, данные заполнены исходя из имеющихся данных, значения для которых данных не хватило были удалены, скорректировы значения больше 340 (разделены на 100), меньше 15 (домножены на 10).
- Пустые значения признака модель выделены в отдельную категорию 'undefined'.
- У признаков пробег и бренд существенных аномалий не выявлено.
- Значение '0' у признака месяц регистрации в нашем случае принят за 'undefined'.
- Выявлен факт того, что в некоторых случаях нам неизвестно была ли машина в ремонте. Данный факт выделен в отдельную категорию, сам признак в количественный, где 0 будет отсутствие ремонта, 1 ремонт был и 2 - неопределено (таким образом можно будет определить вес каждой категории)

Шаг 2. Подготовка выборки для обучения моделей: 
Категориальные признаки трансформированы в цифровой формат, а так же выборки разделены на обучающую и тестовую для проверки качества предсказания моделей в соотношении 80:20.

Шаг 3. Обучение моделей и выбор лучшей:
Для заказчика важны оценки качества предсказания и скорости обучения.

Шаг 4. Анализ времени обучения, времени предсказания и качества моделей:
Для оценки качества моделей применялась метрика RMSE.
Значение метрики RMSE должно было получиться меньше 2500, данное значение достигнуто для всех моделей кроме линейной регресии. 

Шаг 5. Выбор лучшей модели, опираясь на критерии заказчика, с последующей проверкой её качества на тестовой выборке.

## Итог исследования:

* мы провели анализ исходного датасета, обработали дубликаты, пропуски и выбросы
* провели кодирование и масштабирование признаков для ML
* протестировали по 2 модели линейной регрессии и градиентного бустинга (библиотека LightGBM): с дефолтными гиперпараметрами и с подобранными с помощью GridSearchCV
* сделали вывод о том, что лучший результат по RMSE достигается моделью, которая дольше всего обучалась (дефолтный LightGBM).


## Стек технологий:

`pandas`, `matplotlib`, `numpy`, `seaborn`, `GridSearchCV`, `LightGBM`
