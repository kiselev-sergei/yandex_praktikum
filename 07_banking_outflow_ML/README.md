# Отток клиентов банка

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

## Цель исследования:

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Построить модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до значения 0.59.

## Ход исследования:

1. Загружены и подготовлены данные. 
2. Исследован баланс классов, и обучена модель без учёта дисбаланса, с описанием выводов.
3. Улучшение качества модели, учитывая дисбаланс классов. Обучены разные модели и найдена лучшая.
4. Проведено финальное тестирование.

Было изучено и применено:
* Работа с новыми метриками классификации: точностью, полнотой, F1-мерой и AUC-ROC.
* Взвешивание классов, уменьшение и увеличение выборки, а также настройка порогов в классификации.
* В задачах регрессии оценка качества модели новыми метриками: R2 и MAE.

## Итог исследования:

Методом прямого кодирования преобразован весь датафрейм, что позволило избежать дамми-ловушки.

Данные были разбиты на три части: обучающую, валидационную и тестовую. Исходные данные разбиты в соотношении 3:1:1. Произведено масштабирование количественных признаков. Был замечен дисбаланс классов в целевом признаке, модели были изучены с/без учета данного факта, при этом использовались такие метрики как, accuracy, recall, precision, F-1 score, AUC-ROC. Для борьбы с дисбалансом использованы такие методы как: балансировка, увеличение выборки и уменьшение выборки.

Мы поработали с данными об уходе клиентов «Бета-Банка», чтобы построить модель, которая помогла бы сохранять текущих клиентов, так как это для компании обходилось бы дешевле, чем привлекать новых. Для этого изучили данные по 10 000 прошлых клиентов, из которых порядка 20% от услуг банка ранее отказались. Провели предобработку данных, после чего приступили к исследованию задачи. Проанализировали модели без учёта дисбаланса, результаты нас не устроили, поэтому стали строить модели с учётом дисбаланса. 
Оптимальной моделью стал случайный лес с апсемплингом, что подтверждается результатами тестирования на тестовой выборке (F1 = 0,61) и метрики AUC-ROC (0,84). 


## Стек технологий:

`pandas`, `matplotlib`, `numpy`, `scikit-learn`
