# Машинное обучение в бизнесе — выбор локации для скважины

Вы работаете в добывающей компании «ГлавРосГосНефть». Нужно решить, где бурить новую скважину. 
Шаги для выбора локации обычно такие:
- В избранном регионе собирают характеристики для скважин: качество нефти и объём её запасов;
- Строят модель для предсказания объёма запасов в новых скважинах;
- Выбирают скважины с самыми высокими оценками значений;
- Определяют регион с максимальной суммарной прибылью отобранных скважин.

Вам предоставлены пробы нефти в трёх регионах. Характеристики для каждой скважины в регионе уже известны. 

Данные геологоразведки трёх регионов находятся в файлах: 

- geo_data_0.csv
- geo_data_1.csv
- geo_data_2.csv

- id — уникальный идентификатор скважины;
- f0, f1, f2 — три признака точек (неважно, что они означают, но сами признаки значимы);
- product — объём запасов в скважине (тыс. баррелей).

Условия задачи:
- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.

## Цель исследования:

Построить модель для определения региона, где добыча принесёт наибольшую прибыль. Проанализировать возможную прибыль и риски техникой Bootstrap.

## Ход исследования:

Шаг 1. Загрузка и подготовка данных. 

Шаг 2. Обучение и проверка модели для каждого региона:

 2.1. Разбивка данных на обучающую и валидационную выборки в соотношении 4:1.
 
 2.2. Обучение модели и предсказание на валидационной выборке.
 
 2.3. Сохранение предсказаний и правильных ответов на валидационной выборке.
 
 2.4. Вывод на экран среднего запаса предсказанного сырья и RMSE модели.
 
 2.5. Анализ результатов.
 
Шаг 3. Подготовка к расчёту прибыли:

 3.1. Все ключевые значения для расчётов сохранены в отдельных переменных.
 
 3.2. Рассчитан достаточный объём сырья для безубыточной разработки новой скважины. Проведено сравнение полученного объёма сырья со средним запасом в каждом регионе. 
 
 3.3. Написан вывод по этапу подготовки расчёта прибыли.
 
Шаг 4. Написание функции для расчёта прибыли по выбранным скважинам и предсказаниям модели:

 4.1. Выбор скважины с максимальными значениями предсказаний. 
 
 4.2. Просуммировано целевое значение объёма сырья, соответствующее этим предсказаниям.

 4.3. Рассчет прибыли для полученного объёма сырья.
 
Шаг 5. Расчет рисков и прибыли для каждого региона:

 5.1. Выявлено распределение прибыли, с применением техники Bootstrap с 1000 выборок 
 
 5.2. Поиск средней прибыли, 95%-й доверительный интервал и риск убытков, где убыток — это отрицательная прибыль.
 
 5.3. Описание выводов с предложением региона для разработки скважин и обоснованием выбора.


Отработаны следующие навыки:
* Отличие офлайн-метрики от онлайн-метрик.
 
* Расчет доверительных интервалов и бизнес-метрик техникой Bootstrap.
 
* Проведение кросс-валидации, чтобы выводы о качестве модели были более надёжными.

## Итог исследования:

В данном проекте мы изучили нефтяные месторождения трех регионов с целью выбора самого выгодного для бурения скважин в рамках обозначенного бюджета. Для этого мы:
* изучили три датасета, 
* обучили по ним модель линейной регрессии, 
* проанализировали бизнес-термины, составили функции для расчета прибыли с учетом различных условий бизнеса;
* с помощью процедуры бутстреп оценили соотношение рисков и прибыли, что позволило выбрать оптимальный регион для бурения новых скважин. 

Отметим, что по первоначальным данным обучения моделей этот регион казался наименее интересным с точки зения запасов нефти, однако бутстрепирование показало, что именно он наименее рискованный и обещает самую стабильную и высокую прибыль для бизнеса.

Стек технологий:

pandas, numpy, scikit-learn
