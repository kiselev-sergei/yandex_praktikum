# Прогнозирование заказов такси

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.

Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

Вам нужно:

1. Загрузить данные и выполнить их ресемплирование по одному часу.
2. Проанализировать данные.
3. Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
4. Проверить данные на тестовой выборке и сделать выводы.


Данные лежат в файле `taxi.csv`. Количество заказов находится в столбце `num_orders` (от англ. *number of orders*, «число заказов»).

Содержание

1.  Подготовка
    - 1.1  Загрузка библиотек и датасетов
    - 1.2.  Ресемплирование и проверка на монотонность
2.  Анализ
3.  Обучение
    - 3.1  LinearRegression
    - 3.2  RandomForestRegressor
    - 3.5  CatBoostRegressor
4.  Тестирование


## Цель исследования:

На основе собранных исторических данных о заказах такси в аэропортах нужно спрогнозировать количество заказов такси на следующий час, чтобы привлекать больше водителей в период пиковой нагрузки. Построить модель для такого предсказания, используя полученные знания о временных рядах.

## Ход исследования:

Шаг 1. Загрузим данные и выполним их ресемплирование по одному часу.

Шаг 2. Проанализируем данные.

Шаг 3. Обучим разные модели с различными гиперпараметрами. Сделаем тестовую выборку размером 10% от исходных данных.

Шаг 4. Проверим данные на тестовой выборке и сделаем выводы.

## Итог исследования:

В работе над проектом мы:

*    проанализировали датафрейм с временными рядами.

*   выявили общий тренд - количество заказов такси увеличивается от месяца к месяцу.

*    определили часовую сезонность: 3 пика заказов приходятся на периоды с 8 до 10, с 15 до 17, в районе полуночи. Абсолютный минимум заказов приходится на раннее утро.

*    выявили недельную сезонность: минимум заказов приходится на вторники и воскресенья, максимум - на понедельники и пятницы.

*    создали для моделей дополнительные признаки: календарные (месяц, день, день недели, часы), предыдущие значения с размером отставания в 1-5 часов, скользящие средние с шириной окна в 3 часа, по дням (24 часа) и за 3 дня. Дополнительно создали столбец, который содержит разницу между количеством заказов в предыдущий и предшествующий тому часы.

*   обучили три различные модели: линейной регрессии, случайного леса и градиентного бустинга из библиотеки CatBoost.

Лучше всего на обучающей выборке справилась модель случайного леса в регрессии (25,2), хуже всего - модель линейной регрессии (30,5). Лучшая модель (модель случайного леса в регрессии с n_estimators=7) на тестовой выборке показывает RMSE=46.15.

## Стек технологий:

`pandas`, `matplotlib`, `numpy`, `scikit-learn`, `CatBoostRegressor`, `statsmodels`, `TimeSeriesSplit`

