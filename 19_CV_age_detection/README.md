# Определение возраста покупателей

Описание проекта:

Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:

    Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
    Контролировать добросовестность кассиров при продаже алкоголя.

Задача: построить модель, которая по фотографии определит приблизительный возраст человека на основании датасета из фотографий людей с указанием возраста.

Инструкция по выполнению проекта

1. Проведите исследовательский анализ набора фотографий: 
    - Посмотрите на размер выборки.
    - Постройте график распределения возраста в выборке.
    - Напечатайте на экране 10–15 фотографий и посмотрите, как устроен датасет.
2. Подготовьте данные к обучению.
3. Обучите нейронную сеть и рассчитайте её качество.

## Ход исследования:

Шаг 1. Загрузим данные, извлечь данные из папки вам поможет новый метод ImageDataGenerator —flow_from_dataframe(dataframe, directory, ...).

Шаг 2. Проведем исследовательский анализ данных:
- Посмотрим на размер выборки.
- Построим график распределения возраста в выборке.
- Напечатаем на экране 10–15 фотографий и посмотрите, как устроен датасет.

Шаг 3. Построим и обучим свёрточную нейронную сеть на датасете с фотографиями людей. Добьемся значения MAE на тестовой выборке не больше 8.
Функцией потерь не обязательно должна быть MAE, но зачастую нейронные сети с функцией потерь MSE обучаются быстрее.

Шаг 4. Проверим, что методы load_train(path) и load_test(path) корректно работают с данными. В папке path содержится CSV-файл labels.csv с двумя колонками file_name и real_age и папка с изображениями /final_files. Прочитаем данные из CSV-файла labels.csv в датафрейм, который будет одним из параметров метода ImageDataGenerator —flow_from_dataframe(dataframe, directory, ...).
Функцию загрузки тестовой выборки load_test(path) напишем самостоятельно. Вместе со старыми функциями в коде должны быть:
- load_train(path),
- load_test(path),
- create_model(input_shape),
- train_model(model, train_data, test_data, batch_size, epochs, steps_per_epoch, validation_steps).

Шаг 5. Проведем анализ обученной модели.


## Итог исследования:

В представленном датасете распределение по годам стремится к нормальной форме.

Всего 7591 фотографий, больше всего фотографий в диапазоне от 20 до 50 лет. 

Некоторые фотографии уже повернуты или обрезаны, размеры 224*224. Возможно, это повлияет на обучение и предсказания.

Модель обучена на 10 эпохах. 7591 изображение поделено на батчи по 16 изображений, что дает обучение на 356 шагах и валидацию на 119 шагах.

Модель за 10 эпох не переобучается, значение Mean absolute error на валидационной выборке стабильно падает (с 17 до 5,9), а на тестовой выборке тоже не растёт.

MAE на тестовой выборке составило 5,9961, что соответствует условиям от заказчика (MAE ниже 8), цель проекта достигнута.

Такое значение абсолютной средней ошибки говорит о том, что модель всё ещё может ошибаться в определении возраста человека на фотографии почти на 6 лет. Это позволяет в целом решать первую поставленную задачу заказчика (анализировать покупки и предлагать товары, которые могут заинтересовать покупателей той или иной возрастной группы), но требует доработки для решения задачи контроля добросовестность кассиров при продаже алкоголя, так как модель пока ещё может легко спутать 16-летнего с 22-летним.

## Стек технологий:

`pandas`, `matplotlib`, `numpy`, `tensorflow`, `keras`, `ResNet50`, `Adam`, `ImageDataGenerator`
