# Предсказание стоимости жилья в Калифорнии за 1990 год

В проекте вам нужно обучить модель линейной регрессии на данных о жилье в Калифорнии в 1990 году. 

В колонках датасета содержатся следующие данные:
- longitude — широта;
- latitude — долгота;
- housing_median_age — медианный возраст жителей жилого массива;
- total_rooms — общее количество комнат в домах жилого массива;
- total_bedrooms — общее количество спален в домах жилого массива;
- population — количество человек, которые проживают в жилом массиве;
- households — количество домовладений в жилом массиве;
- median_income — медианный доход жителей жилого массива;
- median_house_value — медианная стоимость дома в жилом массиве;
- ocean_proximity — близость к океану.

План по выполнению проекта
- Инициализировать локальную Spark-сессию.
- Прочитать содержимое файла /datasets/housing.csv.
- Вывести типы данных колонок датасета, использовав методы pySpark.
- Выполнить предобработку данных:
   - Исследовать данные на наличие пропусков и заполните их, выбрав значения по своему усмотрению.
   - Преобразовать колонку с категориальными значениями техникой One hot encoding.
- Построить две модели линейной регрессии на разных наборах данных:
   - используя все данные из файла;
   - используя только числовые переменные, исключив категориальные.
- Для построения модели использовать оценщик LinearRegression из библиотеки MLlib.
- Сравните результаты работы линейной регрессии на двух наборах данных по метрикам RMSE, MAE и R2. Сделать выводы.

## Цель исследования:

На основе данных нужно предсказать медианную стоимость дома в жилом массиве. Обучите модель и сделайте предсказания на тестовой выборке. Для оценки качества модели используйте метрики RMSE, MAE и R2.

## Ход исследования:

Шаг 1. Инициализация локальной Spark-сессию.

Шаг 2. Прочтение содержимого файла 

Шаг 3. Вывод типа данных колонок датасета с использованием методов pySpark.

Шаг 4. Выполнена предобработка данных:
  * Исследованы данные на наличие пропусков, пропуски заполнены медианным значением признака
  * Преобразована колонка с категориальными значениями техникой One hot encoding.

Шаг 5. Построение двух моделей линейной регрессии на разных наборах данных. Для построения модели использован оценщик LinearRegression из библиотеки MLlib:
  * с использованием всех данные из файла;
  * с использованием только числовые переменные, исключив категориальные.

Шаг 6. Сравнение результатов работы линейной регрессии на двух наборах данных по метрикам RMSE, MAE и R2. Оформление выводов.

В рамках данного проекта были использованы принципы работы систем хранения и обработки больших данных с использованием Spark, при работе с ним можно выполнять разные типы задач, не перегружая память одного компьютера. 

## Итог исследования:
Root Mean Squared Error (RMSE) on test data = 68985.5

Root Mean Squared Error (RMSE) on test_data_num = 69179.1

Чем меньше среднеквадратичное отклонение, тем лучше модель регрессии. Соответственно, лучше справляется модель, учитывающая категориальный признак.

MAE on test data = 50088.6

MAE on test_data_num = 50873.8

Среднее абсолютное отклонение тоже ниже у модели, учитывающей категориальный признак.

r2 on test data = 0.648494

r2 on test_data_num = 0.646518

Значения метрики R2 в целом удовлетворительные, но на всех признаках сразу модель показывает результат на 0,02 лучше, чем только на числовых признаках.

Вывод, который можно сделать: при прогнозе стоимости недвижимости такой признак, как удаленность от океана (выраженный категориально), играет существенную роль, и при его удалении из модели ее качество падает.

## Стек технологий:
`pandas`, `numpy`, `pyspark`
